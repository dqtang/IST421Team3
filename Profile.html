<!doctype html>
<html>
<head> 
<link rel="stylesheet" href="Profile.css" type = "text/css">
<meta charset="utf-8">
<title>Flex Media Profile Page</title>
	
<style>
	
	 section .profile-stats{
		text-align:right right;
		color: black;
	}
	
	#profileNumbers{
		float:right;
		width: 69%;
		background-color: rgba(181,181,181,1.00);
	}
	
	#profilePic{
		float: left
		
	}
	
	
</style>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script>
		const params = new URLSearchParams(document.location.search);
			const id_token = params.get('id_token');
	
			function decodeJwtResponse(id_token){
								var base64Url = id_token.split('.')[1];
								var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
								var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
									return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
								}).join(''));
	
								return JSON.parse(jsonPayload);
							};
			const responsePayload = decodeJwtResponse(id_token);
	
			firstName = responsePayload.given_name;
			lastName = responsePayload.family_name;
			profileImageUrl = responsePayload.picture;
			email = responsePayload.email;
			gID = responsePayload.sub;
	</script>

<body>

	<header>
		<h3 id ="Name">User</h3>
		<hr>
	</header>
	
	
		<section>
		<div>
		<img class= "profilePic" alt="image" src="tech.PNG" name = "profilePic" id = "profilePic" width="100" height="100"/>
			</div>
			<script>
				//Change Profile Pic
				$(".profilePic").attr("src", profileImageUrl);

				document.getElementById("Name").innerHTML = firstName + " " + lastName;
			</script>

	</section>
	</hr>

</body>
</html>
<header>
<div>
	<div class="profile">


			<div class="profile-user-settings">

				<h1 class="may2958">&nbsp;</h1>


				<button class="btn profile-settings-btn" aria-label="profile settings"><i class="fas fa-cog" aria-hidden="true"></i></button>

			</div>

			<div class="profile-stats">

	
					<li><span class="profile-stat-count" id="postCount">0</span> Posts</li>
					<li><span class="like-stat-count" id="likeCount">0</span> Likes</li>
				</ul>

			</div>

			<div class="profile-bio">

				<p class="profile-real-name" id="Name2">User</span></p>

			</div>
			<script> document.getElementById("Name2").innerHTML = firstName + " " + lastName;
			</script>

		</div>
		<!-- End of profile section -->

	</div>
	<!-- End of container -->

</header>

<main>

	<div class="container">

		<div class="gallery">

			<div class="gallery-item" tabindex="0">



				<list id="userRecentPostLists">


				</list>


			</div>



		</div>
				
			</div>
		

		<script>

			$.ajax({
				url:"http://localhost/Profile.php",
				type:'POST',
				data: {'profileID':gID},
				success: function(data){
					var userActivity = data;
		
					var parse_userActivity = JSON.parse(userActivity);
					console.log(parse_userActivity);
					
					var listDiv=document.getElementById('userRecentPostLists');
					var ul=document.createElement('ul');
		
					ul.setAttribute("style", "list-style-type:none");
					
					for( var i=0; i<parse_userActivity.length; ++i){
						const img = document.createElement('img');
						var li=document.createElement('li');

						var li2 = document.createElement('li2')
		
						img.src= "http://localhost/image/" + parse_userActivity[i].Picture;
		
						img.setAttribute('width', '400px');
						img.setAttribute('height', '400px');
						img.setAttribute('class','activityImage');
		
						li.setAttribute("style", "list-style-type:none");
		
						li.innerHTML = parse_userActivity[i].First_Name + " " +parse_userActivity[i].Last_Name;
						li2.innerHTML = "Created On: " + parse_userActivity[i].TimeStamp +"<br>"+"<br>";
						listImg = ul.appendChild(li) + ul.appendChild(img) + ul.appendChild(li2);
					};listDiv.appendChild(ul);
					
					document.getElementById("postCount").innerHTML= parse_userActivity.length;
		
				}
			})

		
		</script>
		<!-- End of gallery -->

	
	<!-- End of container -->

</main>